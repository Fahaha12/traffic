# 主题切换和页面更新说明

## 修复的问题

### 1. 主题切换问题修复 ✅

**问题描述**: 日间模式和夜间模式切换时，有些文字会变化但背景黑色不变，显示不正常。

**解决方案**:
- 更新了CSS变量系统，支持完整的浅色/深色主题切换
- 修复了Header组件的主题切换逻辑
- 添加了主题设置的本地存储功能

**具体修改**:

1. **CSS变量更新** (`src/assets/styles/main.css`)
   ```css
   /* 浅色主题 (默认) */
   :root {
     --bg-color: #ffffff;
     --bg-color-light: #f5f5f5;
     --bg-color-lighter: #fafafa;
     --text-color: #303133;
     --text-color-light: #606266;
     --text-color-lighter: #909399;
     --border-color: #dcdfe6;
     --border-color-light: #e4e7ed;
   }
   
   /* 深色主题 */
   html.dark {
     --bg-color: #0a0a0a;
     --bg-color-light: #1a1a1a;
     --bg-color-lighter: #2a2a2a;
     --text-color: #ffffff;
     --text-color-light: #cccccc;
     --text-color-lighter: #999999;
     --border-color: #333333;
     --border-color-light: #444444;
   }
   ```

2. **Header组件更新** (`src/components/Layout/Header.vue`)
   - 默认主题改为浅色模式
   - 添加主题设置的本地存储
   - 添加组件初始化时的主题恢复逻辑

### 2. 告警中心页面创建 ✅

**功能特性**:
- 告警统计面板（严重、高级、中级、未读告警数量）
- 告警筛选功能（级别、类型、状态、时间范围）
- 告警列表展示（表格形式，支持分页）
- 告警详情对话框
- 告警操作（标记已读、处理、删除）
- 批量操作（全部标记已读、清空所有告警）

**页面结构**:
```
src/views/AlertCenter.vue
├── 告警统计卡片
├── 筛选条件表单
├── 告警列表表格
└── 告警详情对话框
```

**路由配置**:
```typescript
{
  path: '/alerts',
  name: 'AlertCenter',
  component: () => import('@/views/AlertCenter.vue'),
  meta: { 
    title: '告警中心',
    requiresAuth: true,
    permissions: ['alerts:view']
  }
}
```

**权限更新**:
- 在用户store中添加了 `alerts:view` 和 `alerts:manage` 权限

### 3. 系统设置页面完善 ✅

**现有功能**:
- 基本设置（系统名称、语言、时区、自动刷新）
- 地图设置（提供商、中心点、缩放级别、显示选项）
- 视频设置（质量、自动播放、控制栏、缓冲时间）
- 告警设置（声音、通知、保留时间、级别过滤）
- 用户管理（用户列表、添加、编辑、删除）

**地图设置更新**:
- 默认中心点坐标更新为郑州市政府：`[34.7466, 113.6253]`

## 技术实现

### 主题切换机制
1. **CSS变量系统**: 使用CSS自定义属性实现主题变量
2. **类名切换**: 通过添加/移除 `dark` 类名切换主题
3. **本地存储**: 主题设置保存到localStorage，页面刷新后自动恢复
4. **响应式更新**: 所有组件自动响应主题变化

### 告警中心功能
1. **模拟数据**: 提供完整的告警数据示例
2. **筛选系统**: 支持多维度筛选和重置
3. **状态管理**: 告警的读取状态和处理状态管理
4. **交互体验**: 点击行查看详情，支持批量操作

### 权限系统
1. **路由守卫**: 基于权限的路由访问控制
2. **菜单显示**: 根据用户权限显示/隐藏菜单项
3. **操作权限**: 页面内操作基于权限控制

## 使用说明

### 主题切换
1. 点击Header右上角的主题切换按钮（太阳/月亮图标）
2. 主题设置会自动保存，下次访问时自动恢复
3. 支持浅色模式和深色模式完整切换

### 告警中心
1. 访问 `/alerts` 路径或点击侧边栏"告警中心"菜单
2. 查看告警统计和筛选告警
3. 点击告警行查看详细信息
4. 使用操作按钮管理告警状态

### 系统设置
1. 访问 `/settings` 路径或点击用户菜单中的"系统设置"
2. 在相应标签页中修改配置
3. 点击"保存设置"按钮应用更改

## 注意事项

1. **开发模式**: 当前在开发模式下跳过了认证检查，直接访问主界面
2. **模拟数据**: 告警中心和系统设置使用模拟数据，实际使用时需要连接后端API
3. **主题兼容**: 所有组件都已适配新的主题系统
4. **权限控制**: 权限系统已配置，但需要后端支持才能完全生效

## 后续优化建议

1. **实时告警**: 集成WebSocket实现实时告警推送
2. **告警规则**: 添加告警规则配置功能
3. **通知系统**: 集成浏览器通知API
4. **数据导出**: 添加告警数据导出功能
5. **主题定制**: 支持用户自定义主题颜色
